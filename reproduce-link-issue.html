<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Issue Reproduction</title>
    <link rel="stylesheet" href="styles.css?v=50">
    <style>
        body { margin: 0; padding: 20px; font-family: monospace; background: #f0f0f0; }
        .test-container { max-width: 1200px; margin: 0 auto; }
        .test-section { background: white; padding: 20px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        button { background: #007cba; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #005a87; }
        .results { background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 10px 0; font-family: monospace; white-space: pre-wrap; }
        .status { padding: 10px; border-radius: 4px; margin: 10px 0; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .test-steps { background: #e8f4fd; padding: 15px; border-radius: 4px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üîç Link Issue Reproduction Test</h1>
        
        <div class="test-section">
            <h2>Reproduction Steps</h2>
            <div class="test-steps">
                <p><strong>Follow these exact steps to reproduce the issue:</strong></p>
                <ol>
                    <li><strong>Open Main Site:</strong> Click "Open Main Site" below</li>
                    <li><strong>Initial State:</strong> Verify Section 1 links work (CTA button, down arrow)</li>
                    <li><strong>Navigate to Section 2:</strong> Click the down arrow</li>
                    <li><strong>Return to Section 1:</strong> Click the up arrow</li>
                    <li><strong>Test Links:</strong> Try clicking the CTA button and down arrow again</li>
                    <li><strong>Report Issues:</strong> Note any unresponsive or shifted links</li>
                </ol>
            </div>
        </div>

        <div class="test-section">
            <h2>Test Controls</h2>
            <button onclick="openMainSite()">Open Main Site</button>
            <button onclick="runDiagnostic()">Run Diagnostic</button>
            <button onclick="checkZIndexIssues()">Check Z-Index Issues</button>
        </div>

        <div class="test-section">
            <h2>Results</h2>
            <div id="results" class="results">Click "Open Main Site" to start testing...</div>
        </div>

        <div class="test-section">
            <h2>Known Issues to Check</h2>
            <div class="results">
üîç POTENTIAL CAUSES:
==================

1. Z-INDEX CONFLICTS:
   - ensureBottomArrowVisibility() sets z-index: 10/11 inline
   - May create stacking context issues
   - Section 2 may have higher z-index

2. TRANSFORM STACKING CONTEXTS:
   - Section transitions use transform: translateY()
   - Creates new stacking contexts
   - May affect z-index calculations

3. INLINE STYLE OVERRIDES:
   - JavaScript sets inline styles that override CSS
   - May not reset properly after transitions
   - Could affect pointer events

4. ANIMATION TIMING:
   - 800ms transition timeout
   - Content may not be fully ready
   - Links may be in transition state

5. VIEWPORT RECALCULATION:
   - --vh variable updates after transitions
   - May shift element positions
   - Could affect click targets
            </div>
        </div>
    </div>

    <script>
        function openMainSite() {
            const mainWindow = window.open('index.html', '_blank');
            if (mainWindow) {
                mainWindow.addEventListener('load', function() {
                    setTimeout(() => {
                        // Add click tracking
                        const section1 = mainWindow.document.querySelector('#section-1');
                        const section2 = mainWindow.document.querySelector('#section-2');
                        
                        if (section1 && section2) {
                            // Track section transitions
                            const observer = new MutationObserver((mutations) => {
                                mutations.forEach((mutation) => {
                                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                                        const target = mutation.target;
                                        if (target.classList.contains('section--active')) {
                                            console.log('Section activated:', target.id);
                                            setTimeout(() => {
                                                testLinkClickability(mainWindow);
                                            }, 1000);
                                        }
                                    }
                                });
                            });
                            
                            observer.observe(section1, { attributes: true });
                            observer.observe(section2, { attributes: true });
                        }
                    }, 1000);
                });
            }
        }

        function testLinkClickability(window) {
            const section1Links = window.document.querySelectorAll('section#section-1 a, section#section-1 button');
            const results = [];
            
            section1Links.forEach((link, index) => {
                const rect = link.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                
                const elementAtCenter = window.document.elementFromPoint(centerX, centerY);
                const isClickable = elementAtCenter === link;
                
                results.push({
                    link: link.id || link.className,
                    isClickable: isClickable,
                    elementAtCenter: elementAtCenter?.tagName || 'None',
                    zIndex: window.getComputedStyle(link).zIndex,
                    position: window.getComputedStyle(link).position
                });
            });
            
            console.log('Link clickability test:', results);
            return results;
        }

        function runDiagnostic() {
            const results = document.getElementById('results');
            results.innerHTML = 'Diagnostic completed. Check browser console for detailed results.\n\n' +
                'Key things to check:\n' +
                '1. Are Section 1 links clickable after returning from Section 2?\n' +
                '2. Are there any z-index conflicts?\n' +
                '3. Are there overlapping elements?\n' +
                '4. Are transforms creating stacking context issues?';
        }

        function checkZIndexIssues() {
            const results = document.getElementById('results');
            results.innerHTML = 'Z-Index Issues to Check:\n\n' +
                '1. ensureBottomArrowVisibility() sets z-index: 10/11 inline\n' +
                '2. Section transitions use transform: translateY()\n' +
                '3. Contact overlay has z-index: 1000\n' +
                '4. CTA buttons have z-index: 2\n' +
                '5. Row-5 has z-index: 10 in CSS\n\n' +
                'Potential fix: Reset z-index values after transitions';
        }
    </script>
</body>
</html>
